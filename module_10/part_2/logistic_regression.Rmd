---
title: "Logistic Regression"
author: "Amelia Bertozzi-Villa"
date: "February 22, 2017"
output: html_document
---

## Script for e/log definitions

## Script for odds definitions

## Script for Logistic regression intro/motivation

## Script for example in R



```{r}
# Logistic regression example
library(data.table)
library(ggplot2)

data(mtcars)
mtcars <- data.table(mtcars)

# transform "am" to a categorical variable
mtcars[, type:= ifelse(am==1, "manual", "auto")]

# plot initial results
ggplot(mtcars, aes(x=mpg, y=vs)) +
  geom_point(aes(color=type))


# logistic regression with mpg
logistic_mpg <- glm(vs~mpg, data=mtcars, family=binomial)
summary(logistic_mpg)

# logicstic regression with mpg and type
logistic_mpg_type <- glm(vs~mpg+type, data=mtcars, family=binomial)
summary(logistic_mpg_type)

# predict probability of a straight engine
mtcars[, prob_sengine:=predict(logistic_mpg_type, type="response")]

#plot logistic results
ggplot(mtcars, aes(x=mpg)) +
  geom_point(aes(y=vs, color=type)) +
  geom_line(aes(y=prob_sengine, color=type), size=1)

```
